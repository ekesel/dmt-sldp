# Architecture

> Auto-generated by /map on 2026-02-14

## Overview

DMT-SLDP is a multi-tenant SaaS platform built with a Django backend and a Next.js frontend monorepo. It features strict data isolation via PostgreSQL schemas, real-time telemetry through WebSockets, and asynchronous task processing with Celery.

```
┌─────────────────────────────────────────┐
│        Next.js Portals (Admin/App)      │
├─────────────────────────────────────────┤
│        Django REST API (Multi-tenant)   │
├─────────────────────────────────────────┤
│   PostgreSQL (Schema) | Redis | Celery  │
└─────────────────────────────────────────┘
```

## Components

### Backend (Django)
- **Purpose:** Core business logic, multi-tenancy management, and data aggregation.
- **Location:** `backend/`
- **Modules:**
    - `core/`: Settings and core utilities (Telemetry, Celery).
    - `tenants/`: Tenant and domain management using `django-tenants`.
    - `data/`: Core models, sync tasks, and compliance engine.
    - `users/`: Platform user and external identity management.

### Frontend Monorepo (Next.js)
- **Purpose:** Unified frontend applications and packages.
- **Location:** `frontend/`
- **Apps:**
    - `apps/admin`: Platform administration portal.
    - `apps/app`: Company/Tenant analytics portal.
- **Packages:**
    - `packages/api`: Multi-tenant Axios client.
    - `packages/ui`: Shared Tailwind component library.

## Data Flow

1. **Extraction:** Celery tasks (`sync_tenant_data`) use connectors to fetch data from Jira and GitHub.
2. **Attribution:** `IdentityService` maps external emails/usernames to internal users.
3. **Compliance:** `ComplianceEngine` evaluates `WorkItem` records against DMT rules.
4. **Insights:** `refresh_ai_insights` triggers Gemini AI analysis on normalized metrics.
5. **Consumption:** Next.js portals fetch live metrics and receive real-time updates via Django Channels.

## Integration Points

| Service | Type | Purpose |
|---------|------|---------|
| Jira | REST | Project management data sync |
| GitHub | REST | Pull request and code registry sync |
| Gemini AI | API | Compliance and productivity insights |

## Technical Debt

- [ ] Transition from JWT to secure session-based authentication.
- [ ] Implement robust token rotation for third-party connectors.
- [ ] Expand automated test coverage for the `ComplianceEngine`.
- [ ] Optimize WebSocket event filtering for high-scale tenants.

## Conventions

**Naming:** PEP8 for Python, CamelCase for React components.
**Structure:** Feature-based app modularity in Django, monorepo workspaces in Next.js.
**Testing:** Pytest for backend, Jest/TLR for frontend (scaffolded).
